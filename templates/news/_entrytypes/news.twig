{#
 # News entry template
 # -------------------
 #
 # This template gets loaded whenever a News entry’s URL is
 # requested. That’s because the News section’s Template setting is
 # set to “news/_entry”, the path to this template.
 #
 # When this template is loaded, it will already have an ‘entry’
 # variable, set to the requested News entry.
 #
 # See this page for more details on how Craft routes requests:
 # http://craftcms.com/docs/routing
 #}
 {#{% set asset = "fart" %}#}
    {% switch entry.type %}
        {% case 'oldnews' %}

            {% set asset = entry.oldNewsImage.one() %}

            {% set date = "" %}

        {% case 'news' %}

            {% set asset =  entry.image.one() %}
            {% set date = '<span class="date">' ~ entry.postDate.format('F d, Y') ~ '</span>' %}

    {% endswitch %}

 {% set relatedTags = entry.tags.all() %}

{% extends "_layouts/generic-page-layout.twig" %}


{% block content %}
    {% set date = '<span class="date">' ~ entry.postDate.format('F d, Y') ~ '</span>' %}
    <!-- blog single -->
    <section>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 py-100">
                    <div class="border rounded bg-white">

                        {% if asset | length %}
                            {% set imgCredit =   asset.imageCredit ?? null %}
                            {% set imgCaption =  asset.imageCaption ?? null %}
                            {% set newsImage = craft.imager.transformImage(asset,
                                [
                                    { width: 320, position: asset.getFocalPoint(), jpegQuality: 65,ratio: 4/3, cropZoom:1.5 },
                                    { width: 840, position: asset.getFocalPoint(),jpegQuality: 90 },
                                ],
                                {
                                    format: 'jpg',
                                    allowUpscale: true,
                                    mode: 'crop',
                                    jpegQuality: 90,
                                    interlace: true
                                }
                                ) %}
                            <figure>
                                <picture>
                                    <source media="(max-width: 320px)" sizes="100vw" srcset="{{ newsImage[0].url }}">
                                    <source media="(max-width: 840px)" sizes="100vw" srcset="{{ newsImage[1].url }}">
                                    <img class="img-fluid w-100 rounded-top" src="{{ newsImage[1].url }}" alt="{{ asset.title }}">
                                </picture>
{#                                {%  if imgCaption or imgCredit %}#}
{#                                    <figcaption>#}
{#                                        <i class="fa fa-chevron-up" aria-hidden="true"></i>  {{ imgCaption }}#}

{#                                        {% if imgCredit %}<span class="credit">© {{ imgCredit }}</span>{%  endif %}#}

{#                                    </figcaption>#}
{#                                {% endif %}#}
                            </figure>
                        {% endif %}

                        <div class="p-4">
                            <h3>{{entry.title}}</h3>
                            <ul class="list-inline d-block pb-4 border-bottom mb-3">
                                {#  actual author  {{entry.author}}#}
                                <li class="list-inline-item text-color">Posted By admin</li>
                                <li class="list-inline-item text-color">On {{entry.postDate.format('d F Y')}}</li>
                                <li class="list-inline-item text-color">Tag: Jobs, Strategy</li>
                            </ul>
                            <div class="old-blog-body">{{ entry.body | replace({'<h1>':"<h3>",'</h1>':"</h3>"}) | raw }}</div>

                        </div>
                    </div>
                    <!-- share -->
                    <div class="py-4 border-bottom mb-100">
                        <div class="row">
                            <div class="col-lg-5 mb-4 mb-lg-0">
                                <!-- share-icon -->
                                <div class="d-flex">
                                    <span class="font-weight-light mt-2 mr-3">Share:</span>
                                    <ul class="list-inline d-inline-block">
                                        <li class="list-inline-item">
                                            <a class="share-icon bg-facebook" href="#">
                                                <i class="ti-facebook"></i>
                                            </a>
                                        </li>
                                        <li class="list-inline-item">
                                            <a class="share-icon bg-twitter" href="#">
                                                <i class="ti-twitter-alt"></i>
                                            </a>
                                        </li>
                                        <li class="list-inline-item">
                                            <a class="share-icon bg-linkedin" href="#">
                                                <i class="ti-linkedin"></i>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-lg-7">
                                <!-- tags -->
                                <div class="d-flex">
                                    <span class="font-weight-light mt-2 mr-3">Tags:</span>
                                    <ul class="list-inline tag-list">
                                        {% for rel in relatedTags %}
                                            <li class="list-inline-item"><a href="{{ url('tags/'~rel.slug) }}">{{ rel.title }}</a></li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="col-lg-4">
                    <!-- Sidebar -->
                    <div class="bg-white px-4 py-100 sidebar-box-shadow">
                        <!-- Search Widget -->
                        <div class="mb-50">
                            <h4 class="mb-3">Search Here</h4>
                            <div class="search-wrapper">
                                <form action="{{ url('news/search/results') }}">
                                    <input type="text" class="form-control" name="q" placeholder="Type Here...">
                                </form>
                            </div>
                        </div>
                        <!-- categories -->

                        <!-- Widget Recent Post -->
                        <div class="mb-50">
                            <h4 class="mb-3">Recent News</h4>
                            {% set entries = craft.entries()
                                .section('news')
                                .limit('5') %}


                                {% for entry in entries.all() %}
                                    {% switch entry.type %}
                                    {% case 'oldnews' %}

                                        {% set asset = entry.oldNewsImage.one() %}

                                        {% set date = "" %}

                                    {% case 'news' %}

                                        {% set asset =  entry.image.one() %}
                                        {% set date = '<span class="date">' ~ entry.postDate.format('F d, Y') ~ '</span>' %}

                                    {% endswitch %}
                                    {%  if asset %}
                                        {% set newsImage = craft.imager.transformImage(asset,
                                            [
                                                { width: 70, height:70, position: asset.getFocalPoint(), jpegQuality: 85 },
                                            ],
                                            {
                                                format: 'jpg',
                                                allowUpscale: true,
                                                mode: 'crop',
                                                jpegQuality: 90,
                                                interlace: true
                                            }
                                            ) %}
                                    <div class="d-flex py-3 border-bottom">
                                        <div class="mr-4">
                                            <a href="{{entry.url}}">
                                                <img class="rounded" src="{{ newsImage[0].url }}" alt="photo from article {{entry.title}}">
                                            </a>
                                        </div>
                                        <div>
                                            <h6 class="mb-3">
                                                <a class="text-dark" href="{{entry.url}}">{{ entry.title }}</a>
                                            </h6>
                                            <p class="meta">{{entry.postDate.format('d M, Y')}}</p>
                                        </div>
                                    </div>
                                    {% endif %}
                                {% endfor %}


                        </div>
                        <!-- Widget Tags -->

                        {% if relatedTags|length %}
                        <div class="mb-50">
                            <h4 class="mb-3">Tags</h4>

                                <ul class="list-inline tag-list">
                                    {% for rel in relatedTags %}
                                        <li class="list-inline-item"><a href="{{ url('tags/'~rel.slug) }}">{{ rel.title }}</a></li>
                                    {% endfor %}
                                </ul>
                        </div>
                        {% endif %}
                        <!-- Widget Newsletter -->
                        <div class="newsletter">
                            <h4 class="mb-3">Stay Updated</h4>
                            <form action="#">
                                <input type="text" name="name" id="name" class="form-control" placeholder="Name">
                                <input type="email" name="email" id="email" class="form-control" placeholder="Email">
                                <button type="submit" class="btn btn-primary btn-sm">Subscribe</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- /blog-single -->



    <section class="hide news entry-{{ entry.type }} white pt-4">
        <div class="container">
            <div class="row ">
                <div class="col-xs-12 col-md-8 ">
                    <h1 class="mb-3">{{ entry.title }}</h1>

                   {%  if date | length %} {{ date |raw }} {% endif %}



                    {% if asset | length %}
                        {% set imgCredit =   asset.imageCredit ?? null %}
                        {% set imgCaption =  asset.imageCaption ?? null %}
                        {% set newsImage = craft.imager.transformImage(asset,
                        [
                        { width: 320, position: asset.getFocalPoint(), jpegQuality: 65,ratio: 4/3, cropZoom:1.5 },
                        { width: 840, position: asset.getFocalPoint(),jpegQuality: 90 },
                        ],
                        {
                        format: 'jpg',
                        allowUpscale: true,
                        mode: 'crop',
                        jpegQuality: 90,
                        interlace: true
                        }
                        ) %}
                            <figure>
                            <picture>
                                <source media="(max-width: 320px)" sizes="100vw" srcset="{{ newsImage[0].url }}">
                                <source media="(max-width: 840px)" sizes="100vw" srcset="{{ newsImage[1].url }}">
                                <img class="img-fluid" src="{{ newsImage[1].url }}" alt="{{ asset.title }}">
                            </picture>
                                {%  if imgCaption or imgCredit %}
                                <figcaption>
                                    <i class="fa fa-chevron-up" aria-hidden="true"></i>  {{ imgCaption }}

                                    {% if imgCredit %}<span class="credit">© {{ imgCredit }}</span>{%  endif %}

                                </figcaption>
                                {% endif %}
                            </figure>
                    {% endif %}
                    <div class="mt-4 mb-5">

                        {% switch entry.type %}
                            {% case 'oldnews' %}
                                {% if entry.body |length %}
                                    {{ entry.body }}
                                {% endif %}

                            {% case 'news' %}

                                {% set blockPrefix = "" %}
                                {# get new style block layout #}
                                {% if entry.type == 'news' %}
                                    {% for block in entry.contentBlock.all() %}
                                        {% include ('pages/_partials/_' ~ blockPrefix ~ 'block_' ~ block.type.handle) %}
                                        {% if block.type.handle == "image" %}
                                            {% set lazyImage = true %}
                                        {% endif %}
                                    {% endfor %}
                                {% endif %}
                        {% endswitch %}
                    </div>

                    <!-- tags -->
                    <div class="row tags">
                        <div class="col-12 mb-5">
{#                            {% for tag in entry.tags.all() %}#}

{#                                <span class="badge"><i class="fa fa-tags"></i> <a#}
{#                                            href="{{ siteUrl }}topics/{{ tag.title |lower| url_encode }}">{{ tag.title }}</a></span>#}
{#                            {% endfor %}#}

                        </div>
                    </div>

{#                    {% include '_includes/social-share.twig' %}#}

                </div>
                <div class="col-xs-12 col-md-3 offset-md-1">
                    {% set entries = craft.entries()
                    .section('news')
                    .limit('15') %}

                    <ul class="list-unstyled">
                        {% for entry in entries.all() %}

                            {%  set date = '<span class="side-date">' ~ entry.postDate.format('F d, Y') ~ '</span>'  %}


                            <li class="media mb-4 ">
                                <a href="{{ entry.url }}">

                                    <div class="media-body">
                                        <h6 class="mt-0 mb-0">{{ entry.title }}</h6>
                                        {{ date | raw }}

                                    </div>
                                </a></li>

                        {% endfor %}
                    </ul>

                </div>

            </div>

        </div>
        </div>
    </section>


    <!-- Page Content -->

    <!-- /.container -->
{% endblock %}
